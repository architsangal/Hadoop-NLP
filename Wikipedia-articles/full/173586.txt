[ April 2009 ] { Charles Wheatstone, who first described it in 1854. } The Playfair cipher or Playfair square is a manual symmetric encryption technique and was the first literal digraph substitution cipher. The scheme was invented in 1854 by Charles Wheatstone, but bears the name of Lord Playfair who promoted the use of the cipher. The technique encrypts pairs of letters (digraphs), instead of single letters as in the simple substitution cipher and rather more complex Vigenère cipher systems then in use. The Playfair is thus significantly harder to break since the frequency analysis used for simple substitution ciphers does not work with it. Frequency analysis can still be undertaken, but on the 600 { No duplicate letters are allowed, and one letter is omitted (Q) or combined (I/J), so the calculation is 600 = 25×24. } possible digraphs rather than the 26 possible monographs. The frequency analysis of digraphs is possible, but considerably more difficult – and it generally requires a much larger ciphertext in order to be useful. [ History ] { Lord Playfair, who heavily promoted its use. } Despite its invention by Wheatstone, it became known as the Playfair cipher after Lord Playfair, who heavily promoted its use.The first recorded description of the Playfair cipher was in a document signed by Wheatstone on 26 March 1854. It was rejected by the British Foreign Office when it was developed because of its perceived complexity. When Wheatstone offered to demonstrate that three out of four boys in a nearby school could learn to use it in 15 minutes, the Under Secretary of the Foreign Office responded, &quot; That is very possible, but you could never teach it to attachés. &quot; It was used for tactical purposes by British forces in the Second Boer War and in World War I and for the same purpose by the Australia ns and Germans during World War II. This was because Playfair is reasonably fast to use and requires no special equipment. A typical scenario for Playfair use would be to protect important but non-critical secrets during actual combat. By the time the enemy cryptanalysts could break the message, the information would be useless to them. Between February 1941 and September 1945 the Government of New Zealand used it for communication between New Zealand, the Chatham Islands and the Pacific Islands [ The History of Information Assurance (IA) Government Communications Security Bureau New Zealand Government http://www.gcsb.govt.nz/about-us/history-ia.html 2011-12-24 ] Playfair is no longer used by military forces because of the advent of digital encryption devices. Playfair is now regarded as insecure for any purpose, because modern computers could easily break the cipher within seconds. The first published solution of the Playfair cipher was described in a 19-page pamphlet by Lieutenant Joseph O. Mauborgne, published in 1914. [ Description ] The Playfair cipher uses a 5 by 5 table containing a key word or phrase. Memorization of the keyword and 4 simple rules was all that was required to create the 5 by 5 table and use the cipher. To generate the key table, one would first fill in the spaces in the table with the letters of the keyword (dropping any duplicate letters), then fill the remaining spaces with the rest of the letters of the alphabet in order (usually omitting &quot; Q &quot; to reduce the alphabet to fit; other versions put both &quot; I &quot; and &quot; J &quot; in the same space). The key can be written in the top rows of the table, from left to right, or in some other pattern, such as a spiral beginning in the upper-left-hand corner and ending in the center. The keyword together with the conventions for filling in the 5 by 5 table constitute the cipher key. To encrypt a message, one would break the message into digraphs (groups of 2 letters) such that, for example, &quot; HelloWorld &quot; becomes &quot; HE LL OW OR LD &quot;, and map them out on the key table. If needed, append a &quot; Z &quot; to complete the final digraph. The two letters of the digraph are considered as the opposite corners of a rectangle in the key table. Note the relative position of the corners of this rectangle. Then apply the following 4 rules, in order, to each pair of letters in the plaintext: If both letters are the same (or only one letter is left), add an &quot; X &quot; after the first letter. Encrypt the new pair and continue. Some variants of Playfair use &quot; Q &quot; instead of &quot; X &quot;, but any uncommon monograph will do. If the letters appear on the same row of your table, replace them with the letters to their immediate right respectively (wrapping around to the left side of the row if a letter in the original pair was on the right side of the row). If the letters appear on the same column of your table, replace them with the letters immediately below respectively (wrapping around to the top side of the column if a letter in the original pair was on the bottom side of the column). If the letters are not on the same row or column, replace them with the letters on the same row respectively but at the other pair of corners of the rectangle defined by the original pair. The order is important – the first letter of the encrypted pair is the one that lies on the same row as the first letter of the plaintext pair. To decrypt, use the INVERSE (opposite) of the last 3 rules, and the 1st as-is (dropping any extra &quot; X &quot; s (or &quot; Q &quot; s) that don&apos;t make sense in the final message when finished). [ Example ] Using &quot; playfair example &quot; as the key, (assuming I and J are interchangeable) the table becomes: File:Playfair Cipher building grid omitted letters.png { P L A Y F } { I R E X M } { B C D G H } { K N O Q S } { T U V W Z } Encrypting the message &quot; Hide the gold in the tree stump &quot; : { HI DE TH EG OL DI NT HE TR EX ES TU MP } { ^ } 1. The pair HI forms a rectangle, replace it with BM File:Playfair Cipher 01 HI to BM.png 2. The pair DE is in a column, replace it with OD File:Playfair Cipher 02 DE to OD.png 3. The pair TH forms a rectangle, replace it with ZB File:Playfair Cipher 03 TH to ZB.png 4. The pair EG forms a rectangle, replace it with XD File:Playfair Cipher 04 EG to XD.png 5. The pair OL forms a rectangle, replace it with NA File:Playfair Cipher 05 OL to NA.png 6. The pair DI forms a rectangle, replace it with BE 7. The pair NT forms a rectangle, replace it with KU 8. The pair HE forms a rectangle, replace it with DM 9. The pair TR forms a rectangle, replace it with UI 10. The pair EX (X inserted to split EE) is in a row, replace it with XM File:Playfair Cipher 10 EX to XD.png 11. The pair ES forms a rectangle, replace it with MO 12. The pair TU is in a row, replace it with UV 13. The pair MP forms a rectangle, replace it with IF { BM OD ZB XD NA BE KU DM UI XM MO UV IF } Thus the message &quot; Hide the gold in the tree stump &quot; becomes &quot; BMODZBXDNABEKUDMUIXMMOUVIF &quot;. [ Clarification with pictures ] Assume one wants to encrypt the digraph OR. There are three general cases: 1) Hence, OR - &gt; YZ 2) Hence, OR - &gt; BY 3) Hence, OR - &gt; ZX * * * * * * O Y R Z * * * * * * * * * * * * * * * * * O * * * * B * * * * * * * * * R * * * * Y * * Z * * O * * * * * * * * * * * R * * X * * * * * * [ Cryptanalysis ] Like most classical ciphers, the Playfair cipher can be easily cracked if there is enough text. Obtaining the key is relatively straightforward if both plaintext and ciphertext are known. When only the ciphertext is known, brute force cryptanalysis of the cipher involves searching through the key space for matches between the frequency of occurrence of digrams (pairs of letters) and the known frequency of occurrence of digrams in the assumed language of the original message. Cryptanalysis of Playfair is similar to that of four-square and two-square ciphers, though the relative simplicity of the Playfair system makes identifying candidate plaintext strings easier. Most notably, a Playfair digraph and its reverse (e.g. AB and BA) will decrypt to the same letter pattern in the plaintext (e.g. RE and ER). In English, there are many words which contain these reversed digraphs such as REceivER and DEpartED. Identifying nearby reversed digraphs in the ciphertext and matching the pattern to a list of known plaintext words containing the pattern is an easy way to generate possible plaintext strings with which to begin constructing the key. A different approach to tackling a Playfair cipher is the shotgun hill climbing method. This starts with a random square of letters. Then minor changes are introduced (i.e. switching letters, rows, or reflecting the entire square) to see if the candidate plaintext is more like standard plaintext than before the change (perhaps by comparing the digraphs to a known frequency chart). If the new square is deemed to be an improvement, then it is adopted and then further mutated to find an even better candidate. Eventually, the plaintext or something very close is found to achieve a maximal score by whatever grading method is chosen. This is obviously beyond the range of typical human patience, but computers can adopt this algorithm to crack Playfair ciphers with a relatively small amount of text. Another aspect of Playfair that separates it from four-square and two-square ciphers is the fact that it will never contain a double-letter digraph, e.g. EE. If there are no double letter digraphs in the ciphertext and the length of the message is long enough to make this statistically significant, it is very likely that the method of encryption is Playfair. A good tutorial on reconstructing the key for a Playfair cipher can be found in chapter 7, &quot; Solution to Polygraphic Substitution Systems, &quot; of Field Manual 34-40-2, produced by the United States Army. A detailed cryptanalysis of Playfair is undertaken in chapter 28 of Dorothy L. Sayers &apos; mystery novel Have His Carcase. In this story, a Playfair message is demonstrated to be cryptographically weak, as the detective is able to solve for the entire key making only a few guesses as to the formatting of the message (in this case, that the message starts with the name of a city and then a date). Sayers&apos; book includes a detailed description of the mechanics of Playfair encryption, as well as a step-by-step account of manual cryptanalysis. The German Army, Air Force and Police used the Double Playfair system as a medium-grade cipher in WWII, but as they had broken the cipher early in WWI, they adapted it by introducing a second square from which the second letter of each bigram was selected, and dispensed with the keyword, placing the letters in random order. But with the German fondness for pro forma messages, they were broken at Bletchley Park. Messages were preceded by a sequential number, and numbers were spelt out. As the German numbers 1 (eins) to twelve (zwölf) contain all but eight of the letters in the Double Playfair squares, pro forma traffic was relatively easy to break (Smith, page 74-75) [ Modern Comparisons ] Computer-run block ciphers work in a manner similar to Playfair’s: they break the original message into blocks of characters and apply a complex mathematical transformation, based upon the key, to each of those blocks. Naturally, modern ciphers are not restricted to upper-case, no-punctuation, J-less messages. Any form of data that can be stored on a computer can be encrypted with a modern cipher. A modern block cipher can be run in a mode similar to that of Playfair, where the same block (in Playfair, a pair of letters) always encrypts to the same bit of ciphertext: in our example, CO will always come out as OW. Indeed, many poorly written encryption programs use just this technique, called Electronic Codebook, or ECB. { http://en.wikipedia.org/wiki/Electronic_codebook } More sophisticated implementation of a cipher will use one of many other modes. The most common is called Cipher Feedback Mode, or CFB. CFB starts by encrypting something other than your message, to get things started. This bit at the front of things is called an initialization vector, or IV. The IV need not be secret, but the same IV should never be re-used with the same encryption key. First, encrypt the IV. Take the IV and combine it with the first block of the plaintext. With computers, this is done with a mathematical function called a binary XOR; a similar effect could be accomplished with Playfair by &quot; adding &quot; the two together: C + H = K; W + F = B. It is this value which is written to the ciphertext. Next, take the result from the last step, encrypt it as normally, and add it to the next block from the plaintext. In this way, the encryption of each block depends upon the encryption of each preceding block. Encrypt IV - &gt; XOR (add) result with first block of plaintext - &gt; write as ciphertext - &gt; encrypt from previous - &gt; XOR with next block of plaintext - &gt; write as ciphertext - &gt; repeat The example encoded with Playfair modified in this way, using an IV of &quot; AB &quot; might look thus: OKHKBGVF… This process greatly increases the security of the encryption system. When done with computers, the speed of the processing of the encryption is not significantly hindered. [ In popular culture ] The novel Have His Carcase by Dorothy L. Sayers gives a blow-by-blow account of the cracking of a Playfair cipher. In the film National Treasure: Book of Secrets, a treasure hunt clue is encoded as Playfair cipher. In the audio book Rogue Angel : God of Thunder, a Playfair cipher clue is used to send Anja Creed to Venice. [ See also ] Topics in cryptography four-square [ Notes ] [ References ] Smith, Michael Station X: The Codebreakers of Bletchley Park (1998, Channel 4 Books/Macmillan, London) ISBN 0-7522-2189-2 [ External links ] Online encrypting and decrypting Playfair with JavaScript Extract from some lecture notes on ciphers – Digraphic Ciphers: Playfair [ classical ] Category:Classical ciphers Category:English inventions br:Karrez Playfair ca:Xifratge Playfair cs:Playfairova šifra de:Playfair el:Κρυπτοσύστημα Playfair es:Cifrado de Playfair fr:Chiffre de Playfair id:Sandi Playfair it:Cifrario Playfair he:צופן פלייפייר hu:Playfair-rejtjel nl:Playfaircijfer no:Playfair-chiffer pl:Szyfr Playfair pt:Cifra Playfair ru:Шифр Плейфера fi:Playfair vi:Mật mã Playfair zh:波雷費密碼