[ Lagrange&apos;s identity Lagrange&apos;s identity (disambiguation) ] [ &quot; four-square theorem &quot; and &quot; four square theorem &quot; redirect here. For other uses, see four square (disambiguation). ] Lagrange&apos;s four-square theorem, also known as Bachet&apos;s conjecture, states that any natural number can be represented as the sum of four integer squares p = a_0^2 + a_1^2 + a_2^2 + a_3^2\ where the four numbers [ a0, a1, a2, a3 ] are integers. For illustration, 3, 31 and 310 can be represented as the sum of four squares as follows: 1 2 + 1 2 + 1 2 + 0 2 5 2 + 2 2 + 1 2 + 1 2 17 2 + 4 2 + 2 2 + 1 2. This theorem was proven by Joseph Louis Lagrange in 1770, and corresponds to Fermat&apos;s theorem on sums of two squares. [ Historical development ] The theorem appears in the Arithmetica of Diophantus, translated into Latin by Bachet in 1621. Adrien-Marie Legendre improved on the theorem in 1798 by stating that a positive integer can be expressed as the sum of three squares if and only if it is not of the form [ 4 k (8m+ 7) ]. His proof was incomplete, leaving a gap which was later filled by Carl Friedrich Gauss. [ Proof using the Hurwitz integers ] One of the ways to prove the theorem relies on Hurwitz quaternion s, which are the analog of integer s for quaternion s. [ Stillwell J 2003 Elements of Number Theory Springer-Verlag New York 0-387-95587-9 138–157 ] The Hurwitz quaternions consist of all quaternions with integer components and all quaternions with half-integer components. These two sets can be combined into a single formula \alpha = \frac{1}{2} E_0 (1 + \mathbf{i} + \mathbf{j} + \mathbf{k}) +E_1\mathbf{i} +E_2\mathbf{j} +E_3\mathbf{k} = a_0 +a_1\mathbf{i} +a_2\mathbf{j} +a_3\mathbf{k} where [ E0, E1, E2, E3 ] are integers. Thus, the quaternion components [ a0, a1, a2, a3 ] are either all integers or all half-integers, depending on whether [ E0 ] is even or odd, respectively. The set of Hurwitz quaternions forms a ring; in particular, the sum or product of any two Hurwitz quaternions is likewise a Hurwitz quaternion. The generalized Euclidean algorithm identifies the greatest common right or left divisor of two Hurwitz quaternions, where the &quot; size &quot; of the remainder [ ρ ] is measured by the norm. The norm [ N(α) ] of a quaternion [ α ] is the nonnegative real number \mathrm{N}(\alpha) = \alpha\bar\alpha = a_0^2+a_1^2+a_2^2+a_3^2, where \bar\alpha=a_0 -a_1\mathbf{i} -a_2\mathbf{j} -a_3\mathbf{k} is the conjugate of [ α ]. Since quaternion multiplication is associative, and real numbers commute with other quaternions, the norm of a product of quaternions equals the product of the norms: \mathrm{N}(\alpha\beta)=\alpha\beta\overline{(\alpha\beta)}=\alpha\beta\overline{\beta}\overline{\alpha}=\alpha \mathrm{N}(\beta)\bar\alpha=\alpha\bar\alpha \mathrm{N}(\beta)= \mathrm{N}(\alpha) \mathrm{N}(\beta). The ring of Hurwitz quaternions is Euclidean, since for any quaternion \alpha=a_0+a_1\mathbf{i}+a_2\mathbf{j}+a_3\mathbf{k} with rational coefficients we can choose a Hurwitz quaternion \beta=b_0+b_1\mathbf{i}+b_2\mathbf{j}+b_3\mathbf{k} so that \mathrm{N}(\alpha-\beta) &lt; 1 by first choosing b_0 so that |a_0-b_0| \leq 1/4 and then b_1, b_2, b_3 so that |a_i-b_i| \leq 1/2 for i= 1, 2, 3. Then we obtain \mathrm{N}(\alpha-\beta)=(a_0-b_0)^2+(a_1-b_1)^2+(a_2-b_2)^2+(a_3-b_3)^2 \leq \left(\frac{1}{4} \right)^2+\left(\frac{1}{2}\right)^2+\left(\frac{1}{2}\right)^2+\left(\frac{1}{2}\right)^2=\frac{13}{16} &lt; 1. Therefore, the ring of Hurwitz quaternions is Euclidean and, as a consequense, also a unique factorization domain. Since any natural number can be factored into powers of primes, the four-square theorem therefore holds for all natural numbers if it is true for all prime numbers. It is true for { 0 2 + 0 2 + 1 2 + 1 2 }. To show this for an odd prime integer [ p ], represent it as a quaternion [ (p, 0, 0, 0) ] and assume that it can be factored into two Hurwitz quaternions αβ. The norms of [ p, α, β ] are nonnegative integers such that p2 N(αβ) N(α)N(β). But the norm has only two factors, both [ p ]. Therefore, if it can be factored into Hurwitz quaternions, then [ p ] is the sum of four squares N(α) a0 2 + a1 2 + a2 2 + a3 2. Lagrange proved that any odd prime [ p ] divides at least one number of the form [ 1 + l2 + m2 ], where [ l ] and [ m ] are integers. The latter number can be factored in Hurwitz quaternions: (1 + li+ mj) (1 - li- mj). If [ p ] could not be factored in Hurwitz quaternions, it would be a Hurwitz prime number by definition. Then, by unique factorization, [ p ] would have to divide either [ 1 + li+ mj ] or [ 1 - li- mj ] to form another Hurwitz quaternion. But for [ p &gt; 2 ], the number [ 1/p± l/pi± m/pj ] is not a Hurwitz integer. Therefore, every [ p &gt; 2 ] can be factored in Hurwitz quaternions, and the four-square theorem holds. [ Generalizations ] Lagrange&apos;s four-square theorem is a special case of the Fermat polygonal number theorem and Waring&apos;s problem. Another possible generalisation is the following problem: Given natural number s [ a, b, c, d ], can we solve ax1 2 + bx2 2 + cx3 2 + dx4 2 for all positive integers [ n ] in integers [ x1, x2, x3, x4 ] ? The case [ a= b= c= d= 1 ] is answered in the positive by Lagrange&apos;s four-square theorem. The general solution was given by Ramanujan. He proved that if we assume, without loss of generality, that [ a≤ b≤ c≤ d ] then there are exactly 54 possible choices for [ a, b, c, d ] such that the problem is solvable in integers [ x1, x2, x3, x4 ] for all [ n ]. (Ramanujan listed a 55th possibility [ a= 1, b= 2, c= 5, d= 5 ], but in this case the problem is not solvable if { 15 }. { Myung-Hwan Kim REPRESENTATIONS OF BINARY FORMS BY QUINARY QUADRATIC FORMS } ) [ Algorithms ] Michael O. Rabin and Jeffrey Shallit { M. O. Rabin, J. O. Shallit, Randomized Algorithms in Number Theory, Communications on Pure and Applied Mathematics 39  (1986), no.  S1, pp.  S239–S256. } [ 10.1002/cpa.3160390713 ] have found randomized polynomial-time algorithm s for computing a representation { x1 2 + x2 2 + x3 2 + x4 2 } for a given integer [ n ], in expected running time [ O((logn) 2 ) ]. [ Uniqueness ] The sequence of positive integers whose representation as a sum of four squares is unique (up to order) is: [ A006431 ] 1, 2, 3, 5, 6, 7, 8, 11, 14, 15, 23, 24, 32, 56, 96, 128, 224, 384, 512, 896.... These integers consist of the seven odd numbers 1, 3, 5, 7, 11, 15, 23 and all numbers of the form [ 2 × 4 k, 6 × 4 k ] or [ 14 × 4 k ]. The sequence of positive integers which cannot be represented as a sum of four non-zero squares is: [ A000534 ] 1, 2, 3, 5, 6, 8, 9, 11, 14, 17, 24, 29, 32, 41, 56, 96, 128, 224, 384, 512, 896.... These integers consist of the eight odd numbers 1, 3, 5, 9, 11, 17, 29, 41 and all numbers of the form [ 2 × 4 n, 6 × 4 n ] or [ 14 × 4 n ]. [ See also ] Euler&apos;s four-square identity 15 and 290 theorems Jacobi&apos;s four-square theorem [ Notes ] [ References ] [ Ireland and Rosen A Classical Introduction to Modern Number Theory Springer-Verlag 1990 0-387-97329-X ] [ External links ] Proof at PlanetMath.org Another proof an applet decomposing numbers as sums of four squares Category:Additive number theory Category:Theorems in number theory Category:Articles containing proofs ar:مبرهنة المربعات الأربع للاغرانج ca:Teorema dels quatre quadrats cs:Lagrangeova věta o čtyřech čtvercích de:Vier-Quadrate-Satz es:Teorema de los cuatro cuadrados fr:Théorème des quatre carrés de Lagrange ko:라그랑주의 네 제곱수 정리 it:Teorema dei quattro quadrati he:משפט ארבעת הריבועים של לגראנז&apos; hu:Négynégyzetszám-tétel nl:Vier-kwadratenstelling van Lagrange ja:四平方定理 km:ទ្រឹស្ដីបទការ៉េទាំង៤របស់ឡាហ្គ្រង់ pl:Twierdzenie Lagrange&apos;a o rozkładach liczb naturalnych pt:Teorema de Fermat-Lagrange ru:Теорема Лагранжа о сумме четырёх квадратов fi:Lagrangen neljän neliön lause ta:லாக்ராஞ்சியின் நான்கு வர்க்கத் தேற்றம் uk:Теорема Лагранжа про чотири квадрати zh:四平方和定理